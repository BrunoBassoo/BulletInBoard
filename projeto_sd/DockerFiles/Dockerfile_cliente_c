FROM alpine:3.19

WORKDIR /app

# Instalar ferramentas de build, pkg-config e dependÃªncias (headers + runtime)
RUN apk add --no-cache \
    build-base \
    pkgconfig \
    zeromq-dev \
    msgpack-c-dev \
    ca-certificates

# Copiar o fonte (espera cliente.c em ../cliente.c relativo a este Dockerfile)
COPY ../cliente.c .

# Compilar usando pkg-config para obter flags corretas
RUN gcc -o cliente cliente.c $(pkg-config --cflags --libs libzmq msgpackc)

# Executar
CMD ["./cliente"]